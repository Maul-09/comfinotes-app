var dompet = (function () {
    "use strict";

    var e = $(window).width(),
        t = function () {
            var e = $(window).height() - 206;
            $(".chatbox .msg_card_body").css("height", e);
        };

    return {
        init: function () {
            var n;

            // Metis menu initialization
            if (jQuery("#menu").length > 0) {
                $("#menu").metisMenu();
            }

            // Add active-no-child class to active menu items without children
            jQuery(".metismenu > .mm-active").each(function () {
                if (!jQuery(this).children("ul").length > 0) {
                    jQuery(this).addClass("active-no-child");
                }
            });

            // Check all checkboxes
            $("#checkAll").on("change", function () {
                $("td input, .email-list .custom-checkbox input").prop("checked", $(this).prop("checked"));
            });

            // Toggle navigation control
            $(".nav-control").on("click", function () {
                $("#main-wrapper").toggleClass("menu-toggle");
                $(".hamburger").toggleClass("is-active");
            });

            // Highlight current active menu item
            (function () {
                var e = window.location;
                var t = $("ul#menu a")
                    .filter(function () {
                        return this.href == e;
                    })
                    .addClass("mm-active")
                    .parent()
                    .addClass("mm-active");

                while (t.is("li")) {
                    t = t.parent().addClass("mm-show").parent().addClass("mm-active");
                }
            })();

            // Adjust content-body min-height
            n = window.outerHeight || screen.height;
            if (n) {
                $(".content-body").css("min-height", n + 60 + "px");
            }

            // Handle collapsible cards
            $('a[data-action="collapse"]').on("click", function (e) {
                e.preventDefault();
                $(this).closest(".card").find('[data-action="collapse"] i').toggleClass("mdi-arrow-down mdi-arrow-up");
                $(this).closest(".card").children(".card-body").collapse("toggle");
            });

            // Handle expand cards
            $('a[data-action="expand"]').on("click", function (e) {
                e.preventDefault();
                $(this).closest(".card").find('[data-action="expand"] i').toggleClass("icon-size-actual icon-size-fullscreen");
                $(this).closest(".card").toggleClass("card-fullscreen");
            });

            // Handle close cards
            $('[data-action="close"]').on("click", function () {
                $(this).closest(".card").removeClass().slideUp("fast");
            });

            // Handle reload cards
            $('[data-action="reload"]').on("click", function () {
                var e = $(this);
                e.parents(".card").addClass("card-load");
                e.parents(".card").append('<div class="card-loader"><i class="ti-reload rotate-refresh"></i></div>');
                setTimeout(function () {
                    e.parents(".card").children(".card-loader").remove();
                    e.parents(".card").removeClass("card-load");
                }, 2000);
            });

            // Scroll event for header and navigation
            (function () {
                const e = $(".header").innerHeight();
                $(window).scroll(function () {
                    if (
                        $("body").attr("data-layout") === "horizontal" &&
                        $("body").attr("data-header-position") === "static" &&
                        $("body").attr("data-sidebar-position") === "fixed"
                    ) {
                        $(this.window).scrollTop() >= e
                            ? $(".dlabnav").addClass("fixed")
                            : $(".dlabnav").removeClass("fixed");
                    }
                });
            })();

            // More code for scrollbars, event listeners, and light gallery
            // Add any other functionality as needed
        },

        load: function () {
            setTimeout(function () {
                jQuery("#preloader").remove();
                $("#main-wrapper").addClass("show");
            }, 800);

            if (jQuery(".default-select").length > 0) {
                jQuery(".default-select").niceSelect();
            }
        },

        resize: function () {
            t();
        },

        handleMenuPosition: function () {
            if (e > 1024) {
                $(".metismenu li")
                    .unbind()
                    .each(function () {
                        if ($("ul", this).length > 0) {
                            var t = $("ul:first", this).css("display", "block").offset().left,
                                n = $("ul:first", this).width(),
                                l = $("body").width();
                            $("ul:first", this).removeAttr("style");

                            var isRtl = jQuery("html").hasClass("rtl");
                            if (isRtl ? t + n > l : t <= 0) {
                                $(this).find("ul:first").addClass("left");
                            } else {
                                $(this).find("ul:first").removeClass("left");
                            }
                        }
                    });
            }
        },
    };
})();

jQuery(document).ready(function () {
    $('[data-bs-toggle="popover"]').popover();
    dompet.init();
});

jQuery(window).on("load", function () {
    "use strict";
    dompet.load();
    setTimeout(function () {
        dompet.handleMenuPosition();
    }, 1000);
});

jQuery(window).on("resize", function () {
    "use strict";
    dompet.resize();
    setTimeout(function () {
        dompet.handleMenuPosition();
    }, 1000);
});
